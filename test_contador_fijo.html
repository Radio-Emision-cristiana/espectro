<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Contador de Volumen Fijo</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-family: Arial, sans-serif;
            min-height: 100vh;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }
        
        .control-test {
            position: relative;
            display: inline-block;
            margin: 80px;
            padding: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: left;
        }
        
        .visual-guide {
            margin: 30px 0;
            padding: 15px;
            background: rgba(0, 255, 153, 0.1);
            border-radius: 10px;
            border: 2px solid rgba(0, 255, 153, 0.3);
        }
        
        .test-status {
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            font-family: monospace;
        }
        
        .highlight {
            color: #00ff99;
            font-weight: bold;
        }
        
        .warning {
            color: #ff6b6b;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üéØ Test - Contador de Volumen Posicionado</h1>
        <p>Verificaci√≥n del posicionamiento correcto del contador de porcentaje</p>
        
        <div class="instructions">
            <h3>üìã Test de Posicionamiento:</h3>
            <ol>
                <li><strong>Haz clic en el bot√≥n de volumen</strong> (üîä) de abajo</li>
                <li><strong>Observa la barra vertical</strong> que aparece</li>
                <li><strong>Verifica que el porcentaje</strong> est√© en la parte inferior del contenedor</li>
                <li><strong>Arrastra la barra</strong> y verifica que el contador no se mueva de posici√≥n</li>
                <li><strong>El contador debe permanecer fijo</strong> en la parte inferior, centrado</li>
            </ol>
        </div>
        
        <div class="visual-guide">
            <h3>‚úÖ Comportamiento Esperado:</h3>
            <p>‚Ä¢ El contador debe estar <span class="highlight">siempre en la parte inferior</span> del contenedor de volumen</p>
            <p>‚Ä¢ Debe mantenerse <span class="highlight">centrado horizontalmente</span></p>
            <p>‚Ä¢ No debe <span class="warning">moverse ni desplazarse</span> al usar la barra</p>
            <p>‚Ä¢ Debe <span class="highlight">actualizarse en tiempo real</span> cuando cambies el volumen</p>
        </div>
        
        <div class="control-test">
            <h2>üîä Control de Volumen</h2>
            <p>Haz clic en el bot√≥n para probar:</p>
            
            <!-- Audio para prueba -->
            <audio id="audio-player" loop>
                <source src="https://www.learningcontainer.com/wp-content/uploads/2020/02/Kalimba.mp3" type="audio/mpeg">
            </audio>
            
            <!-- Control de volumen flotante -->
            <div class="floating-volume-container">
                <!-- Bot√≥n flotante -->
                <button class="volume-toggle-btn" id="volume-toggle-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
                        <path d="M3 9v6h4l5 5V4L7 9H3zm7-.17v6.34L7.83 13H5v-2h2.83L10 8.83zM16.5 12A4.5 4.5 0 0014 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77 0-4.28-2.99-7.86-7-8.77z"/>
                    </svg>
                </button>
                
                <!-- Contenedor deslizante de la barra -->
                <div class="volume-slider-container" id="volume-slider-container">
                    <input type="range" id="mini-volume-slider" min="0" max="1" step="0.01" value="0.8">
                    <div class="volume-percentage" id="volume-percentage">80%</div>
                </div>
            </div>
        </div>
        
        <div class="test-status" id="test-status">
            <h3>üìä Estado del Test:</h3>
            <div>Contador visible: <span id="counter-visible">‚ùå</span></div>
            <div>Posici√≥n correcta: <span id="position-correct">‚ùå</span></div>
            <div>Actualizaci√≥n funcional: <span id="update-functional">‚ùå</span></div>
            <div>Estabilidad: <span id="stability-check">‚ùå</span></div>
        </div>
        
        <div class="instructions">
            <h3>üîß Reparaciones Aplicadas:</h3>
            <ul>
                <li>‚úÖ <code>flex-direction: column</code> con <code>justify-content: space-between</code></li>
                <li>‚úÖ <code>order: 1</code> para el slider y <code>order: 2</code> para el contador</li>
                <li>‚úÖ <code>flex-shrink: 0</code> y <code>flex-grow: 0</code> para el contador</li>
                <li>‚úÖ <code>position: relative</code> y <code>z-index: 10001</code> para evitar desplazamientos</li>
                <li>‚úÖ <code>pointer-events: none</code> para evitar interferencias</li>
                <li>‚úÖ Fondo sutil para mejor visibilidad del contador</li>
            </ul>
        </div>
        
        <div style="margin-top: 40px; padding: 20px; background: rgba(255, 255, 255, 0.05); border-radius: 10px;">
            <p><strong>üí° Nota:</strong> Si el contador sigue movi√©ndose, revisa la consola del navegador para logs de debugging.</p>
        </div>
    </div>

    <script src="main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const volumeContainer = document.getElementById('volume-slider-container');
            const volumePercentage = document.getElementById('volume-percentage');
            const volumeSlider = document.getElementById('mini-volume-slider');
            const volumeBtn = document.getElementById('volume-toggle-btn');
            
            let testResults = {
                counterVisible: false,
                positionCorrect: false,
                updateFunctional: false,
                stabilityCheck: false
            };
            
            // Test 1: Contador visible
            if (volumePercentage) {
                testResults.counterVisible = true;
                document.getElementById('counter-visible').textContent = '‚úÖ';
                document.getElementById('counter-visible').style.color = '#00ff99';
            }
            
            // Test 2: Posici√≥n correcta
            if (volumeContainer && volumePercentage) {
                const containerRect = volumeContainer.getBoundingClientRect();
                const percentageRect = volumePercentage.getBoundingClientRect();
                
                // Verificar que el contador est√© en la parte inferior del contenedor
                const isAtBottom = percentageRect.bottom <= containerRect.bottom + 5;
                const isCentered = Math.abs(percentageRect.left - containerRect.left) < 20;
                
                if (isAtBottom && isCentered) {
                    testResults.positionCorrect = true;
                    document.getElementById('position-correct').textContent = '‚úÖ';
                    document.getElementById('position-correct').style.color = '#00ff99';
                }
            }
            
            // Test 3: Actualizaci√≥n funcional
            if (volumeSlider && volumePercentage) {
                let updateCount = 0;
                volumeSlider.addEventListener('input', function() {
                    updateCount++;
                    if (updateCount >= 1) {
                        testResults.updateFunctional = true;
                        document.getElementById('update-functional').textContent = '‚úÖ';
                        document.getElementById('update-functional').style.color = '#00ff99';
                    }
                });
                
                // Simular un cambio para probar
                setTimeout(() => {
                    const event = new Event('input');
                    volumeSlider.dispatchEvent(event);
                }, 1000);
            }
            
            // Test 4: Estabilidad (verificar despu√©s de interacciones)
            setTimeout(() => {
                if (testResults.counterVisible && testResults.positionCorrect && testResults.updateFunctional) {
                    testResults.stabilityCheck = true;
                    document.getElementById('stability-check').textContent = '‚úÖ';
                    document.getElementById('stability-check').style.color = '#00ff99';
                }
            }, 2000);
            
            // Logs de debug
            console.log('üß™ Test de posicionamiento iniciado');
            console.log('üìç Contador encontrado:', volumePercentage ? 'S√ç' : 'NO');
            console.log('üìç Contenedor encontrado:', volumeContainer ? 'S√ç' : 'NO');
            
            // Observer para detectar cambios de posici√≥n
            if (volumePercentage && window.MutationObserver) {
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                            console.log('‚ö†Ô∏è Estilo del contador cambi√≥:', mutation.target.style.cssText);
                        }
                    });
                });
                
                observer.observe(volumePercentage, {
                    attributes: true,
                    attributeFilter: ['style']
                });
            }
        });
    </script>
</body>
</html>